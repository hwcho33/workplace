import{d as e,a2 as a,aS as t,ab as s,al as l,o as r,c as u,b as n,u as o,aO as i,a6 as c,ai as m,aB as d,am as p,ap as v,aq as f,an as b,e as g,a9 as $,Y as y,aQ as h}from"./index-e42e774a.js";import{u as w,c as N}from"./index.esm-9d122fec.js";import{p as k,g as T}from"./customer-a60cf11f.js";import{_ as q,u as x}from"./use-set-options-88b2caad.js";import{p as B,r as j}from"./replace-26e1f01a.js";import"./_baseProperty-cfed1d0d.js";const C={class:"info-find-wrap phone-method"},_={key:0,class:"page-title"},E={class:"inner-wrap"},I={class:"form-wrap"},S={class:"find-tab-wrap"},V={class:"active"},M={href:"javascript:void(0)",class:"tab-btn"},K={for:"userName"},O={class:"input-text-wrap"},D=["placeholder"],L={class:"btns-wrap"},R={for:"userTel"},U={class:"input-text-wrap"},z=["placeholder"],F={class:"btns-wrap"},H={class:"button-group-wrap"},P={class:"input-text-wrap"},A=["placeholder","title"],J={class:"cert-num-wrap"},Q={class:"button-group-wrap"},Y=["disabled"],Z=e({__name:"find-info-mobile",setup(e){const Z=a(),{setBasicOptions:G}=x(),W="PHONE",X=t(),{value:ee,setValue:ae,errorMessage:te,meta:se,validate:le,setErrors:re}=w("userName",N().required($t("message.customer.0017","이름을 입력해 주세요.")).matches(/^([가-힣]{2,10}|[a-zA-Z]{2,20})$/,$t("message.customer.0018","이름을 정확하게 입력해 주세요."))),{value:ue,setValue:ne,errorMessage:oe,meta:ie,validate:ce,setErrors:me}=w("userTel",N().required($t("message.customer.0025","휴대폰 번호를 입력해 주세요.")).matches(/^01([0|1|6|7|8|9])-?([0-9]{3,4})-?([0-9]{4})$/,$t("message.customer.0026","휴대폰 번호를 정확하게 입력해 주세요."))),{value:de,setValue:pe,errorMessage:ve,meta:fe,validate:be,setErrors:ge}=w("certNum",N().required($t("message.customer.0022","인증번호를 입력해 주세요.")).matches(/^[0-9]{4}$/,$t("message.customer.0023","인증번호를 확인 후 다시 입력해 주세요."))),$e=a(null),ye=a(null),he=a(null),we=a(!1),Ne=a(!1),ke=a(!1);let Te,qe=-1,xe=a(300);const Be=a(!1);let je=0;s((()=>{var e,a;null==(e=Z.value)||e.close(),null==(a=$e.value)||a.focus()}));const Ce=l((()=>{const e=xe.value/60,a=Math.floor(e),t=Math.round(60*(e-a));return B(a,2,"0")+":"+B(t,2,"0")}));function _e(e){ae(j(e.target.value,/(\s*)/g,""))}function Ee(e){var a;"Enter"===e.key&&(null==(a=ye.value)||a.focus())}function Ie(){we.value=!0}function Se(e){e.relatedTarget&&"del-btn"===e.relatedTarget.className||(we.value=!1)}function Ve(e){ne(j(e.target.value,/[^0-9]/g,""))}function Me(e){var a;"Enter"===e.key&&(ke.value?null==(a=he.value)||a.focus():Ue())}function Ke(){Ne.value=!0,ue.value&&ne(j(ue.value,/[^0-9]/g,""))}function Oe(e){e.relatedTarget&&"del-btn"===e.relatedTarget.className||(Ne.value=!1),ue.value&&ne(j(j(ue.value,/[^0-9]/g,""),/^(\d{3})(\d{3,4})(\d{4})$/,"$1-$2-$3"))}function De(e){pe(j(e.target.value,/[^0-9]/g,""))}function Le(e){"Enter"===e.key&&He()}async function Re(e=!1){if(!(await le()).valid)return!1;if(!(await ce()).valid)return!1;if(e){if(xe.value<=0)return ge($t("message.customer.0021","입력시간이 지났습니다. 다시 시도해 주세요.")),!1;if(!(await be()).valid)return!1}return!0}async function Ue(){var e;await Re(!1)&&(je++,je>9?null==(e=Z.value)||e.open():function(e=!1){k({srchType:W,phoneNum:ue.value,custNm:ee.value}).then((a=>{const t=y(null==a?void 0:a.data);if(t)switch(t.resultCode){case"7806":s=t.resultData,xe.value=Number(s.validTm)-1,qe=Number(s.seqNum),clearInterval(Te),Be.value=!1,Te=setInterval((()=>{xe.value--,xe.value<=0&&(clearInterval(Te),ge($t("message.customer.0021","입력시간이 지났습니다. 다시 시도해 주세요."))),xe.value<=270&&(Be.value=!0)}),1e3),e&&(ke.value=!0,h((()=>{var e;null==(e=he.value)||e.focus()})));break;case"7807":Fe();break;default:re(""),me($t("message.customer.0068","인증번호 전송에 실패하였습니다. 인증번호 요청을 다시 해주시기 바랍니다."))}else Fe();var s}))}(!0))}function ze(){xe.value>270?ge($t("message.customer.0067","인증번호 요청 후 30초 후에 재전송이 가능합니다.")):(ge(""),Ue())}function Fe(){re(""),me($t("message.customer.0049","입력하신 정보와 일치하는 회원정보가 없습니다."))}async function He(){await Re(!0)&&T({srchType:W,phoneNum:ue.value,custNm:ee.value,certNum:Number(de.value),seqNum:Number(qe)}).then((e=>{const a=y(null==e?void 0:e.data);if(a)switch(a.resultCode){case"7809":t=a.resultData,X.push({path:"/customer/login/find-id-complete",state:{userName:ee.value,idListStr:JSON.stringify(t.loginIdList)}});break;case"7810":Pe();break;case"7811":ge($t("message.customer.0021","입력시간이 지났습니다. 다시 시도해 주세요."))}else Pe();var t}))}function Pe(){ge($t("message.customer.0023","인증번호를 확인 후 다시 입력해 주세요."))}function Ae(){ae("")}function Je(){ne("")}function Qe(){X.replace("/customer/login/find-id-email")}return(e,a)=>(r(),u($,null,[n("div",C,["web"===o(i)()?(r(),u("h2",_,c(e.$t("label.customer.0051","아이디 찾기")),1)):m("",!0),n("div",E,[n("div",I,[n("div",S,[n("ul",null,[n("li",V,[n("a",M,c(e.$t("label.customer.0052","휴대폰 인증")),1)]),n("li",null,[n("a",{href:"javascript:void(0)",class:"tab-btn",onClick:Qe},c(e.$t("label.customer.0053","이메일 인증")),1)])])]),n("div",{class:d(["find-input-wrap",{"is-error":o(se).dirty&&!o(se).valid,"is-complete":o(se).valid&&!o(we)}])},[n("label",K,c(e.$t("label.customer.0008","이름")),1),n("div",O,[p(n("input",{type:"text",placeholder:e.$t("label.customer.0009","예) 홍길동"),name:"userName",ref_key:"userNameRef",ref:$e,required:"","onUpdate:modelValue":a[0]||(a[0]=e=>f(ee)?ee.value=e:null),onInput:_e,onKeydown:Ee,onFocus:Ie,onBlur:Se},null,40,D),[[v,o(ee)]]),n("div",L,[p(n("button",{type:"button",class:"del-btn",onClick:Ae,onBlur:Se},c(e.$t("label.common.0001","삭제")),545),[[b,String(o(ee)).length>0]])])]),p(n("p",{class:"info-msg is-error"},c(o(te)),513),[[b,o(te)]])],2),n("div",{class:d(["find-input-wrap",{"is-error":o(ie).dirty&&!o(ie).valid,"is-complete":o(ie).valid&&!o(Ne)}])},[n("label",R,c(e.$t("label.customer.0010","휴대폰 번호")),1),n("div",U,[p(n("input",{type:"tel",placeholder:e.$t("label.customer.0011","‘-’ 없이 입력"),maxlength:"11",name:"userTel",ref_key:"userTelRef",ref:ye,required:"","onUpdate:modelValue":a[1]||(a[1]=e=>f(ue)?ue.value=e:null),onInput:Ve,onKeydown:Me,onFocus:Ke,onBlur:Oe},null,40,z),[[v,o(ue)]]),n("div",F,[p(n("button",{type:"button",class:"del-btn",onClick:Je,onBlur:Oe},c(e.$t("label.common.0001","삭제")),545),[[b,String(o(ue)).length>0]])])]),p(n("p",{class:"info-msg is-error"},c(o(oe)),513),[[b,o(oe)]]),n("div",H,[p(n("button",{type:"button",class:"send-btn",onClick:Ue},c(e.$t("label.customer.0012","인증번호 전송")),513),[[b,!o(ke)]])])],2),o(ke)?(r(),u("div",{key:0,class:d(["find-input-wrap certification",{"is-error":o(fe).dirty&&!o(fe).valid}])},[n("div",P,[p(n("input",{type:"tel",placeholder:e.$t("label.customer.0056","인증번호 4자리 입력"),maxlength:"4",name:"certNum",ref_key:"certNumRef",ref:he,required:"",title:e.$t("label.customer.0013","인증번호 입력"),"onUpdate:modelValue":a[2]||(a[2]=e=>f(de)?de.value=e:null),onInput:De,onKeydown:Le},null,40,A),[[v,o(de)]]),n("div",J,[n("span",null,c(o(Ce)),1)])]),p(n("p",{class:"info-msg is-error"},c(o(ve)),513),[[b,o(ve)]]),p(n("p",{class:"info-msg is-warning"},c(e.$t("message.customer.0020","입력하신 번호로 인증번호가 발송되었습니다.")),513),[[b,!o(ve)]]),n("div",Q,[n("button",{type:"button",class:d(["retry-btn",{disable:!o(Be)}]),disabled:!o(Be),onClick:ze},c(e.$t("label.customer.0014","재전송")),11,Y),n("button",{type:"button",class:"certify-btn",onClick:He},c(e.$t("label.customer.0015","인증하기")),1)])],2)):m("",!0)])])]),g(q,{ref_key:"baseDialog",ref:Z,"option-props":o(G)({addSelector:"aa",message:e.$t("message.customer.0065","전송횟수가 초과 되었습니다. 10분 후 다시 시도해 주세요."),firstButton:void 0,secondButton:void 0})},null,8,["option-props"])],64))}});export{Z as default};
