import{d as e,a2 as a,aS as t,ab as s,al as l,o as r,c as n,u as o,aO as u,a6 as i,ai as c,b as m,aB as d,am as p,ap as v,aq as f,an as b,a9 as g,ae as h,e as y,Y as w,aQ as $,f as k}from"./index-e42e774a.js";import{u as N,c as x}from"./index.esm-9d122fec.js";import{p as E,g as j}from"./customer-a60cf11f.js";import{_,u as I}from"./use-set-options-88b2caad.js";import{p as q,r as B}from"./replace-26e1f01a.js";import{e as C,s as M,f as T}from"./startsWith-f24641dc.js";import"./_baseProperty-cfed1d0d.js";import"./_baseIndexOf-a9d8fc6d.js";import"./_baseFindIndex-057550ad.js";const z={class:"info-find-wrap phone-method"},S={key:0,class:"page-title"},V={class:"inner-wrap"},A={class:"form-wrap"},F={class:"find-tab-wrap tab-size2"},K={class:"active"},L={href:"javascript:void(0)",class:"tab-btn"},O={for:"userName"},Z={class:"input-text-wrap"},D=["placeholder"],R={class:"btns-wrap"},U={for:"userEmail"},H={class:"input-text-wrap"},J=["placeholder"],P={class:"btns-wrap"},Q={class:"input-complete-wrap"},W=["onMousedown"],Y={class:"user-id"},G={class:"button-group-wrap"},X={class:"input-text-wrap"},ee=["placeholder","title"],ae={class:"cert-num-wrap"},te={class:"button-group-wrap"},se=["disabled"],le=e({__name:"find-info-email",setup(e){const le=a(),{setBasicOptions:re}=I(),ne="EMAIL",oe=["naver.com","hanmail.net","gmail.com","nate.com","daum.net","kakao.com","hotmail.com","korea.com","icloud.com"],ue=t(),{value:ie,setValue:ce,errorMessage:me,meta:de,validate:pe,setErrors:ve}=N("userName",x().required($t("message.customer.0017","이름을 입력해 주세요.")).matches(/^([가-힣]{2,10}|[a-zA-Z]{2,20})$/,$t("message.customer.0018","이름을 정확하게 입력해 주세요."))),{value:fe,setValue:be,errorMessage:ge,meta:he,validate:ye,setErrors:we}=N("userEmail",x().required("이메일을 입력해 주세요.").max(40,"40자 이내로 입력해 주세요.").matches(/^([a-zA-Z0-9\w\.\_\-])+@([a-zA-Z0-9]+\.)+[a-zA-Z0-9]{2,8}$/,$t("message.customer.0009","정확한 이메일 형식으로 입력해 주세요."))),$e=a([]),{value:ke,setValue:Ne,errorMessage:xe,meta:Ee,validate:je,setErrors:_e}=N("certNum",x().required($t("message.customer.0022","인증번호를 입력해 주세요.")).matches(/^[0-9]{4}$/,$t("message.customer.0023","인증번호를 확인 후 다시 입력해 주세요."))),Ie=a(null),qe=a(null),Be=a(null),Ce=a(!1),Me=a(!1),Te=a(!1);let ze,Se=-1,Ve=a(300);const Ae=a(!1);let Fe=0;s((()=>{var e,a;null==(e=le.value)||e.close(),null==(a=Ie.value)||a.focus()}));const Ke=l((()=>{const e=Ve.value/60,a=Math.floor(e),t=Math.round(60*(e-a));return q(a,2,"0")+":"+q(t,2,"0")}));function Le(e){ce(B(e.target.value,/(\s*)/g,""))}function Oe(e){"Enter"===e.key&&qe.value.focus()}function Ze(){Ce.value=!0}function De(e){e.relatedTarget&&"del-btn"===e.relatedTarget.className||(Ce.value=!1)}function Re(e){be(B(e.target.value,/(\s*)/g,""));const a=M(fe.value,"@");if(C(fe.value,"@")&&2===a.length){const e=a[1];$e.value=oe.filter((a=>T(a,e)&&e!==a)).map((a=>({str:B(a,e,""),domain:a})))}else $e.value=[]}function Ue(e){var a;"Enter"===e.key&&(Te.value?null==(a=Be.value)||a.focus():Ye())}function He(){Me.value=!0}function Je(e){e.relatedTarget&&"del-btn"===e.relatedTarget.className||(Me.value=!1,$e.value=[])}function Pe(e){Ne(B(e.target.value,/[^0-9]/g,""))}function Qe(e){"Enter"===e.key&&ea()}async function We(e=!1){if(!(await pe()).valid)return!1;if(!(await ye()).valid)return!1;if(e){if(Ve.value<=0)return _e($t("message.customer.0021","입력시간이 지났습니다. 다시 시도해 주세요.")),!1;if(!(await je()).valid)return!1}return!0}async function Ye(){var e;await We(!1)&&(Fe++,Fe>9?null==(e=le.value)||e.open():function(e=!1){E({srchType:ne,email:fe.value,custNm:ie.value}).then((a=>{const t=w(null==a?void 0:a.data);if(t)switch(t.resultCode){case"7806":!function(e,a){Ve.value=Number(e.validTm)-1,Se=Number(e.seqNum),clearInterval(ze),Ae.value=!1,void(ze=setInterval((()=>{Ve.value--,Ve.value<=0&&(clearInterval(ze),_e($t("message.customer.0021","입력시간이 지났습니다. 다시 시도해 주세요."))),Ve.value<=270&&(Ae.value=!0)}),1e3)),a&&(Te.value=!0,$((()=>{var e;null==(e=Be.value)||e.focus()})))}(t.resultData,e);break;case"7807":Xe();break;default:ve(""),we($t("message.customer.0068","인증번호 전송에 실패하였습니다. 인증번호 요청을 다시 해주시기 바랍니다."))}else Xe()}))}(!0))}function Ge(){Ve.value>270?_e($t("message.customer.0067","인증번호 요청 후 30초 후에 재전송이 가능합니다.")):(_e(""),Ye())}function Xe(){ve(""),we($t("message.customer.0049","입력하신 정보와 일치하는 회원정보가 없습니다."))}async function ea(){await We(!0)&&j({srchType:ne,phoneNum:"",email:fe.value,custNm:ie.value,certNum:Number(ke.value),seqNum:Number(Se)}).then((e=>{const a=w(null==e?void 0:e.data);if(a)switch(a.resultCode){case"7809":t=a.resultData,ue.push({path:"/customer/login/find-id-complete",state:{userName:ie.value,idListStr:JSON.stringify(t.loginIdList)}});break;case"7810":aa();break;case"7811":_e($t("message.customer.0021","입력시간이 지났습니다. 다시 시도해 주세요."))}else aa();var t}))}function aa(){_e($t("message.customer.0023","인증번호를 확인 후 다시 입력해 주세요."))}function ta(){ce("")}function sa(){be("")}function la(){ue.replace("/customer/login/find-id-mobile")}return(e,a)=>(r(),n("div",z,["web"===o(u)()?(r(),n("h2",S,i(e.$t("label.customer.0051","아이디 찾기")),1)):c("",!0),m("div",V,[m("div",A,[m("div",F,[m("ul",null,[m("li",null,[m("a",{href:"javascript:void(0)",class:"tab-btn",onClick:la},i(e.$t("label.customer.0052","휴대폰 인증")),1)]),m("li",K,[m("a",L,i(e.$t("label.customer.0053","이메일 인증")),1)])])]),m("div",{class:d(["find-input-wrap",{"is-error":o(de).dirty&&!o(de).valid,"is-complete":o(de).valid&&!o(Ce)}])},[m("label",O,i(e.$t("label.customer.0008","이름")),1),m("div",Z,[p(m("input",{type:"text",placeholder:e.$t("label.customer.0009","예) 홍길동"),name:"userName",ref_key:"userNameRef",ref:Ie,required:"","onUpdate:modelValue":a[0]||(a[0]=e=>f(ie)?ie.value=e:null),onInput:Le,onKeydown:Oe,onFocus:Ze,onBlur:De},null,40,D),[[v,o(ie)]]),m("div",R,[p(m("button",{type:"button",class:"del-btn",onClick:ta,onBlur:De},i(e.$t("label.common.0001","삭제")),545),[[b,String(o(ie)).length>0]])])]),p(m("p",{class:"info-msg is-error"},i(o(me)),513),[[b,o(me)]])],2),m("div",{class:d(["find-input-wrap",{"is-error":o(he).dirty&&!o(he).valid,"is-complete":o(he).valid&&!o(Me),"is-auto-complete":o(Me)&&o(C)(o(fe),"@")&&o($e).length>0}])},[m("label",U,i(e.$t("label.customer.0054","이메일")),1),m("div",H,[p(m("input",{type:"text",placeholder:e.$t("label.customer.0002","예) nsmall@nsmall.com"),maxlength:"40",name:"userEmail",ref_key:"userEmailRef",ref:qe,required:"","onUpdate:modelValue":a[1]||(a[1]=e=>f(fe)?fe.value=e:null),onInput:Re,onKeydown:Ue,onFocus:He,onBlur:Je},null,40,J),[[v,o(fe)]]),m("div",P,[p(m("button",{type:"button",class:"del-btn",onClick:sa,onBlur:Je},i(e.$t("label.common.0001","삭제")),545),[[b,String(o(fe)).length>0]])]),p(m("ul",Q,[(r(!0),n(g,null,h(o($e),((e,a)=>(r(),n("li",{key:a,onMousedown:a=>function(e){be(M(fe.value,"@")[0]+"@"+e),$e.value=[]}(e.domain)},[m("span",Y,i(o(fe)),1),k(i(e.str),1)],40,W)))),128))],512),[[b,o(Me)&&o(C)(o(fe),"@")&&o($e).length>0]])]),p(m("p",{class:"info-msg is-error"},i(o(ge)),513),[[b,o(ge)]]),m("div",G,[p(m("button",{type:"button",class:"email-btn",onClick:Ye},i(e.$t("label.customer.0055","인증메일 전송")),513),[[b,!o(Te)]])])],2),o(Te)?(r(),n("div",{key:0,class:d(["find-input-wrap certification",{"is-error":o(Ee).dirty&&!o(Ee).valid}])},[m("div",X,[p(m("input",{type:"text",placeholder:e.$t("label.customer.0056","인증번호 4자리 입력"),maxlength:"4",name:"certNum",ref_key:"certNumRef",ref:Be,required:"",title:e.$t("label.customer.0013","인증번호 입력"),"onUpdate:modelValue":a[2]||(a[2]=e=>f(ke)?ke.value=e:null),onInput:Pe,onKeydown:Qe},null,40,ee),[[v,o(ke)]]),m("div",ae,[m("span",null,i(o(Ke)),1)])]),p(m("p",{class:"info-msg is-error"},i(o(xe)),513),[[b,o(xe)]]),p(m("p",{class:"info-msg is-warning"},i(e.$t("message.customer.0066","인증 메일이 발송되었습니다.")),513),[[b,!o(xe)]]),m("div",te,[m("button",{type:"button",class:d(["retry-btn",{disable:!o(Ae)}]),disabled:!o(Ae),onClick:Ge},i(e.$t("label.customer.0014","재전송")),11,se),m("button",{type:"button",class:"certify-btn",onClick:ea},i(e.$t("label.customer.0015","인증하기")),1)])],2)):c("",!0)])]),y(_,{ref_key:"baseDialog",ref:le,"option-props":o(re)({addSelector:"aa",message:e.$t("message.customer.0065","전송횟수가 초과 되었습니다. 10분 후 다시 시도해 주세요."),firstButton:void 0,secondButton:void 0})},null,8,["option-props"])]))}});export{le as default};
